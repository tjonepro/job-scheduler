name: ASP.NET Job Scheduler

on:
  schedule:
    - cron: "*/5 * * * *"   # every 5 minutes (UTC)
  workflow_dispatch:

jobs:
  run-job:
    runs-on: ubuntu-latest

    steps:
      - name: Call job-scheduler securely
        run: |
          echo "Calling secure job handler..."

          TS=$(date +%s)
          NONCE=$(uuidgen)

          curl -sS --fail --max-time 60 \
            -H "X-Job-Secret: ${{ secrets.MyKey1 }}" \
            -H "X-Job-Timestamp: $TS" \
            -H "X-Job-Nonce: $NONCE" \
            "https://tjone.win-pick.com/job-scheduler.ashx"
